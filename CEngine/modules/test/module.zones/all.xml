<!-- Caution: this file is in UTF-8 (no BOM) format and contains Unicode
  characters.  Some text editors do not properly handle Unicode, so use
  caution in editing this file. -->
<deterministic-test>
  <category>zones</category>
  <short-name>no zones</short-name>

  <description>
    Test that the reported number of zones is correct.  In this baseline
    scenario, we declare one zone (the default or "background" zone) and we
    detect a diseased unit, but the detection does not cause a zone focus to be
    established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>1unit</population-file>

  <parameter-file>no_zones</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit will be Latent.
     - On day 2 the unit will be Infectious Clinical.  It will be detected and
       slated for destruction.
     - On day 3 the unit will be destroyed.  No zones will be in effect.  The
       unit's state will appear as Destroyed on day 4.
  </parameter-description>

  <output>
    <tr><td>L</td></tr>
    <tr><td>C</td></tr>
    <tr><td>C</td></tr>
    <tr><td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>no zones, check reporting variables</short-name>

  <description>
    Test that the reported number of zones and reported number of units in
    zones is correct.  In this baseline scenario, we declare one zone (the
    default or "background" zone) and we detect a diseased unit, but the
    detection does not cause a zone focus to be established.
    
    This scenario is identical to "no zones" above, except that it tracks the
    values of output variables rather than the states of units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>1unit</population-file>

  <parameter-file>no_zones_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit will be Latent.
     - On day 2 the unit will be Infectious Clinical.  It will be detected and
       slated for destruction.
     - On day 3 the unit will be destroyed.  No zones will be in effect.  The
       unit's state will appear as Destroyed on day 4.
  </parameter-description>

  <output>
    <tr>
      <td>detnUAll</td>
      <td>unitsInZoneBackground</td>
    </tr>
    <tr><td>0</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>1</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>1 zone, 1 focus, check reporting variables</short-name>

  <description>
    Test that the reported number of zones and reported number of units in
    zones is correct.  In this scenario, we declare a "High risk" and a
    "Background" zone, and detection of a diseased unit causes a zone focus to
    be established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>1unit</population-file>

  <parameter-file>1_zone_1_focus_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 1 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit will be Latent.
     - On day 2 the unit will be Infectious Clinical.  It will be detected and
       slated for destruction.
     - On day 3 a 1 km "High risk" zone will be in effect around the unit, and
       the unit will be destroyed.  The unit's state will appear as Destroyed
       on day 4.
  </parameter-description>

  <diagram>1_zone_1_focus</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>0</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>2 zones, 1 focus, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk", a "Low risk", and a "Background" zone, and detection
    of a diseased unit causes a zone focus to be established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>1unit</population-file>

  <parameter-file>2_zones_1_focus_w_vars</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 1 km in radius and a "Low
    risk" zone 2 km in radius are established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit will be Latent.
     - On day 2 the unit will be Infectious Clinical.  It will be detected and
       slated for destruction.
     - On day 3 a 1 km "High risk" zone and a 2 km "Low risk" zone will be in
       effect around the unit, and the unit will be destroyed.  The unit's
       state will appear as Destroyed on day 4.
  </parameter-description>

  <diagram>2_zones_1_focus</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td> <td>1</td></tr>
    <tr><td>1</td> <td>1</td> <td>0</td></tr>
    <tr><td>1</td> <td>1</td> <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>1 zone, 2 foci</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 2 diseased
    units causes 2 separate zone foci to be established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>1_zone_2_foci</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 1 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 1 km "High risk" zone will be in effect around each of the
       two units, and the units will be destroyed.  The rings will not overlap,
       so the count of separate areas making up the "High risk" zone should be
       2.  The units' states will appear as Destroyed on day 4.
  </parameter-description>

  <diagram>1_zone_2_foci</diagram>

  <output>
    <tr><td>L</td>  <td>L</td></tr>
    <tr><td>C</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>1 zone, 2 foci, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 2 diseased
    units causes 2 separate zone foci to be established.
    
    This scenario is identical to "1 zone, 2 foci" above, except that it tracks
    the values of output variables rather than the states of units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>1_zone_2_foci_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 1 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 1 km "High risk" zone will be in effect around each of the
       two units, and the units will be destroyed.  The rings will not overlap,
       so the count of separate areas making up the "High risk" zone should be
       2.  The units' states will appear as Destroyed on day 4.
  </parameter-description>

  <diagram>1_zone_2_foci</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>2</td></tr>
    <tr><td>2</td> <td>0</td></tr>
    <tr><td>2</td> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>1 zone, 2 foci, merging, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 2 diseased
    units causes 2 zone foci to be established.  The foci overlap and merge.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>1_zone_2_foci_merge_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 5.5 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 5.5 km "High risk" zone will be in effect around each of the
       two units, and the units will be destroyed.  The rings will overlap and
       merge, so the count of separate areas making up the "High risk" zone
       should be 1.  The units' states will appear as Destroyed on day 4.
  </parameter-description>

  <diagram>1_zone_2_foci_merge</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>2</td></tr>
    <tr><td>1</td> <td>0</td></tr>
    <tr><td>1</td> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>2 zones, 2 foci, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk", a "Low risk", and a "Background" zone.  Detection of
    2 diseased units causes 2 separate zone foci to be established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>2_zones_2_foci_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 1 km in radius and a "Low
    risk" zone 2 km in radius are established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 1 km "High risk" zone and a 2 km "Low risk" zone will be in
       effect around each of the two units, and the units will be destroyed.
       The rings will not overlap, so the count of separate areas making up the
       "High risk" zone should be 2 and the count for the "Low risk" zone
       should also be 2.  The units' states will appear as Destroyed on day 4.
  </parameter-description>

  <diagram>2_zones_2_foci</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td> <td>2</td></tr>
    <tr><td>2</td> <td>2</td> <td>0</td></tr>
    <tr><td>2</td> <td>2</td> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>2 zones, 2 foci, merging 1, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk", a "Low risk", and a "Background" zone.  Detection of
    2 diseased units causes 2 zone foci to be established.  The "High risk"
    rings around the 2 foci are separate, but the "Low risk" rings overlap and
    merge.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>2_zones_2_foci_merge1_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 1 km in radius and a "Low
    risk" zone 5.5 km in radius are established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 1 km "High risk" zone and a 5.5 km "Low risk" zone will be in
       effect around each of the two units, and the units will be destroyed.
       The "High risk" rings will not overlap, so the count of separate areas
       making up the "High risk" zone should be 2.  The "Low risk" rings will
       overlap and merge, so the count of separate areas making up the "Low
       risk" zone should be 1.  The units' states will appear as Destroyed on
       day 4.
  </parameter-description>

  <diagram>2_zones_2_foci_merge1</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td> <td>2</td></tr>
    <tr><td>1</td> <td>2</td> <td>0</td></tr>
    <tr><td>1</td> <td>2</td> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>2 zones, 2 foci, merging 2, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk", a "Low risk", and a "Background" zone.  Detection of
    2 diseased units causes 2 zone foci to be established.  The "High risk"
    rings around the 2 foci overlap and merge, and so do the "Low risk" rings.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>23 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>2_zones_2_foci_merge2_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 5.5 km in radius and a
    "Low risk" zone 6.5 km in radius are established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the units will be Latent.
     - On day 2 the units will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 3 a 5.5 km "High risk" zone and a 6.5 km "Low risk" zone will be
       in effect around each of the two units, and the units will be destroyed.
       The "High risk" rings will overlap and merge, so the count of separate
       areas making up the "High risk" zone should be 1.  The "Low risk" rings
       will also overlap and merge, so the count of separate areas making up
       the "Low risk" zone should also be 1.  The units' states will appear as
       Destroyed on day 4.
  </parameter-description>

  <diagram>2_zones_2_foci_merge2</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td> <td>2</td></tr>
    <tr><td>1</td> <td>1</td> <td>0</td></tr>
    <tr><td>1</td> <td>1</td> <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>3 foci merge</short-name>

  <description>
    Test that the reported number of zones is correct when zone foci merge.
    In this scenario, we declare a "High risk" and a "Background" zone.
    Detection of 2 diseased units causes 2 separate zone foci to be
    established, then on the next day, detection of another diseased unit
    between them causes the separate foci to merge.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>26 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_2</population-file>

  <parameter-file>3_foci_merge</parameter-file>

  <parameter-description>
    For pigs, the latent period lasts 1 day, infectiousness lasts 2 days,
    clinical signs accompany infectiousness immediately, and immunity lasts 1
    day.  For cattle, the latent period lasts 2 days, and the remaining
    parameters are the same.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 1.25 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 two pig units (0 and 3) and one cattle unit (1) will be Latent.
     - On day 2 the pig will be Infectious Clinical.  They will be detected and
       and slated for destruction.
     - On day 3 a 1.25 km "High risk" zone will be in effect around each of the
       pig units, and the units will be destroyed.  The zone rings will not
       overlap, so the count of separate areas making up the "High risk" zone
       should be 2.  The infected cattle unit (1) will be Infectious Clinical.
       It will be detected and slated for destruction.
     - On day 4 a 1.25 km "High risk" zone will be in effect around the
       infected cattle unit (1), and the unit will be destroyed.  The zone ring
       will overlap the previously established rings and cause them to merge
       into one large area, so the count of separate areas making up the "High
       risk" zone should be 1.
  </parameter-description>

  <diagram>3_foci_merge</diagram>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>S</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>3 foci merge, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct when zone foci merge.
    In this scenario, we declare a "High risk" and a "Background" zone.
    Detection of 2 diseased units causes 2 separate zone foci to be
    established, then on the next day, detection of another diseased unit
    between them causes the separate foci to merge.

    This scenario is identical to "3 foci merge" above, except that it tracks
    the values of output variables rather than the states of units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>26 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_2</population-file>

  <parameter-file>3_foci_merge_w_vars</parameter-file>

  <parameter-description>
    For pigs, the latent period lasts 1 day, infectiousness lasts 2 days,
    clinical signs accompany infectiousness immediately, and immunity lasts 1
    day.  For cattle, the latent period lasts 2 days, and the remaining
    parameters are the same.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 1.25 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 two pig units (0 and 3) and one cattle unit (1) will be Latent.
     - On day 2 the pig will be Infectious Clinical.  They will be detected and
       and slated for destruction.
     - On day 3 a 1.25 km "High risk" zone will be in effect around each of the
       pig units, and the units will be destroyed.  The zone rings will not
       overlap, so the count of separate areas making up the "High risk" zone
       should be 2.  The infected cattle unit (1) will be Infectious Clinical.
       It will be detected and slated for destruction.
     - On day 4 a 1.25 km "High risk" zone will be in effect around the
       infected cattle unit (1), and the unit will be destroyed.  The zone ring
       will overlap the previously established rings and cause them to merge
       into one large area, so the count of separate areas making up the "High
       risk" zone should be 1.
  </parameter-description>

  <diagram>3_foci_merge</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>2</td> <td>0</td></tr>
    <tr><td>2</td> <td>1</td> <td>2</td></tr>
    <tr><td>1</td> <td>0</td> <td>1</td></tr>
    <tr><td>1</td> <td>0</td> <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>1 zone, 13 foci</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 13 diseased
    units causes 13 separate zone foci to be established.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>31 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>units_circle</population-file>

  <parameter-file>1_zone_13_foci</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 50 km.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 0.2 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit in the centre (0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  It will infect the other units (1-12) by
       airborne spread.
     - On day 3 a 0.2 km "High risk" zone will be in effect around unit 0, and
       unit 0 will be destroyed.  The count of separate areas making up the
       "High risk" zone should be 1.  Units 1-12 will be Latent.
     - On day 4 units 1-12 will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 5 a 0.2 km "High risk" zone will be in effect around each unit,
       and units 1-12 will be destroyed.  The zone rings will not overlap, so
       the count of separate areas making up the "High risk" zone should be 13.
  </parameter-description>

  <diagram>1_zone_13_foci</diagram>

  <output>
    <tr><td>L</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td></tr>
    <tr><td>C</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td> <td>S</td></tr>
    <tr><td>C</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td> <td>L</td></tr>
    <tr><td>D</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td></tr>
    <tr><td>D</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td> <td>C</td></tr>
    <tr><td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td> <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>1 zone, 13 foci, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 13 diseased
    units causes 13 separate zone foci to be established.

    This scenario is identical to "1 zone, 13 foci" above, except that it
    tracks the values of output variables rather than the states of units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>31 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>units_circle</population-file>

  <parameter-file>1_zone_13_foci_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 50 km.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 0.2 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit in the centre (0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  It will infect the other units (1-12) by
       airborne spread.
     - On day 3 a 0.2 km "High risk" zone will be in effect around unit 0, and
       unit 0 will be destroyed.  The count of separate areas making up the
       "High risk" zone should be 1.  Units 1-12 will be Latent.
     - On day 4 units 1-12 will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 5 a 0.2 km "High risk" zone will be in effect around each unit,
       and units 1-12 will be destroyed.  The zone rings will not overlap, so
       the count of separate areas making up the "High risk" zone should be 13.
  </parameter-description>

  <diagram>1_zone_13_foci</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>1</td> <td>0</td></tr>
    <tr><td>1</td> <td>0</td> <td>1</td></tr>
    <tr><td>1</td> <td>12</td> <td>0</td></tr>
    <tr><td>13</td> <td>0</td> <td>12</td></tr>
    <tr><td>13</td> <td>0</td> <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>1 zone, 13 foci, merging, check reporting variables</short-name>

  <description>
    Test that the reported number of zones is correct.  In this scenario, we
    declare a "High risk" and a "Background" zone.  Detection of 13 diseased
    units causes 13 separate zone foci to be established.  The outer 12 merge
    into a ring and subsume the one in the middle.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>31 May 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>units_circle</population-file>

  <parameter-file>1_zone_13_foci_merge_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The probability of airborne spread at 1 km is 0.505, and the maximum
    distance of airborne spread is 50 km.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased unit is
    is detected, a "High risk" zone 0.3 km in radius is established around it.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the unit in the centre (0) will be Latent.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  It will infect the other units (1-12) by
       airborne spread.
     - On day 3 a 0.3 km "High risk" zone will be in effect around unit 0, and
       unit 0 will be destroyed.  The count of separate areas making up the
       "High risk" zone should be 1.  Units 1-12 will be Latent.
     - On day 4 units 1-12 will be Infectious Clinical.  They will be detected
       and slated for destruction.
     - On day 5 a 0.3 km "High risk" zone will be in effect around each unit,
       and units 1-12 will be destroyed.  The zone rings will overlap, and they
       will also surround the ring around unit 0, so the count of separate
       areas making up the "High risk" zone should be 1.
  </parameter-description>

  <diagram>1_zone_13_foci_merge</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
    </tr>
    <tr><td>0</td> <td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>1</td> <td>0</td></tr>
    <tr><td>1</td> <td>0</td> <td>1</td></tr>
    <tr><td>1</td> <td>12</td> <td>0</td></tr>
    <tr><td>1</td> <td>0</td> <td>12</td></tr>
    <tr><td>1</td> <td>0</td> <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>trace, infect</short-name>

  <description>
    This test and the next 6 test that zones can be established by trace outs.
    In this scenario, the index unit ships to and infects two other units.
    Both are found by trace out and destroyed.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_0</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 1.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a cattle or pig
    unit is found by trace-out, a "High risk" zone 2 km in radius is
    established around it.  Note that in this scenario, zone foci are not
    established around detections, only around units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to and infect
       the cattle unit 10 km north (unit 1) and the pig unit 20 km north (unit
       2).
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.  Units 1 and 2 will be Latent.
     - On day 3 a 2 km "High risk" zone will be in effect around units 1 and 2.
       The zone rings will not overlap.  Units 0, 1, and 2 will be destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_both</diagram>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>L</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>trace, no infect</short-name>

  <description>
    This is part of a series of tests that check that zones can be established
    by trace outs.  This scenario is similar to "trace, infect" above, except
    in this scenario, the shipments fail to infect the recipient units.  The
    recipients are still found by trace out and destroyed.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 0.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a cattle or pig
    unit is found by trace-out, a "High risk" zone 2 km in radius is
    established around it.  Note that in this scenario, zone foci are not
    established around detections, only around units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to the cattle
       unit 10 km north (unit 1) and the pig unit 20 km north (unit 2) but will
       fail to infect them.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.
     - On day 3 a 2 km "High risk" zone will be in effect around units 1 and 2.
       The zone rings will not overlap.  Units 0, 1, and 2 will be destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_both</diagram>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, check reporting variables</short-name>

  <description>
    This is part of a series of tests that check that zones can be established
    by trace outs.  In this scenario, the index unit ships to two other units.
    The shipments fail to infect the recipient units, but the recipients are
    still found by trace out and destroyed.

    This scenario is identical to "trace, no infect" above, except that it
    tracks the values of output variables rather than the states of units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>12 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 0.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a cattle or pig
    unit is found by trace-out, a "High risk" zone 2 km in radius is
    established around it.  Note that in this scenario, zone foci are not
    established around detections, only around units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    What should happen:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to the cattle
       unit 10 km north (unit 1) and the pig unit 20 km north (unit 2) but will
       fail to infect them.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.
     - On day 3 a 2 km "High risk" zone will be in effect around units 1 and 2.
       The zone rings will not overlap, so the count of separate areas making
       up the "High risk" zone should be 2.  Units 0, 1, and 2 will be
       destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_both</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>2</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, zone around cattle only, check reporting variables</short-name>

  <description>
    This is part of a series of tests that check that zones can be established
    by trace outs.  In this scenario, the index unit ships to two other units.
    The shipments fail to infect the recipient units, but the recipients are
    still found by trace out and destroyed.  

    This scenario is similar to "trace, no infect" above, except that a zone
    focus is only established around traced cattle units, not traced pig units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>12 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_cattle_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 0.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a cattle unit is
    found by trace-out, a "High risk" zone 2 km in radius is established around
    it.  Note that in this scenario, zone foci are not established around
    detections, only around cattle units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    What should happen:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to the cattle
       unit 10 km north (unit 1) and the pig unit 20 km north (unit 2) but will
       fail to infect them.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.
     - On day 3 a 2 km "High risk" zone will be in effect around unit 1.  The
       count of separate areas making up the "High risk" zone should be 1.
       Units 0, 1, and 2 will be destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_cattle</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, zone around pigs only, check reporting variables</short-name>

  <description>
    This is part of a series of tests that check that zones can be established
    by trace outs.  In this scenario, the index unit ships to two other units.
    The shipments fail to infect the recipient units, but the recipients are
    still found by trace out and destroyed.  

    This scenario is similar to "trace, no infect" above, except that a zone
    focus is only established around traced pig units, not traced cattle units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>12 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_pigs_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 0.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a pig unit is
    found by trace-out, a "High risk" zone 2 km in radius is established around
    it.  Note that in this scenario, zone foci are not established around
    detections, only around pig units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    What should happen:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to the cattle
       unit 10 km north (unit 1) and the pig unit 20 km north (unit 2) but will
       fail to infect them.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.
     - On day 3 a 2 km "High risk" zone will be in effect around unit 2.  The
       count of separate areas making up the "High risk" zone should be 1.
       Units 0, 1, and 2 will be destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_pigs</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, merging, check reporting variables</short-name>

  <description>
    This is part of a series of tests that check that zones can be established
    by trace outs.  In this scenario, the index unit ships to two other units.
    The shipments fail to infect the recipient units, but the recipients are
    still found by trace out and destroyed.

    This scenario is identical to "trace, no infect" above, except that the
    zone rings are larger and they overlap and merge.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>12 Jun 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1_merge_w_vars</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, infectiousness
    lasts 2 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 1 day.

    The movement rate from sheep units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 10 km.  The probability of
    infection given exposure is 0.  Latent units are allowed to infect others.
    Movements from sheep units to pig units are the same.

    The probability of detecting a diseased sheep unit vs. the number of days
    the unit has been showing clinical signs is fixed at 1.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is also fixed at 1.  Diseased cattle and pig units are not detected.

    When a diseased unit is detected, a trace-out is attempted.  The
    probability of success for tracing a movement to any unit is 1.0.
    Recipient units found by trace-out are destroyed.

    There are two zones, "High risk" and "Background".  When a cattle or pig
    unit is found by trace-out, a "High risk" zone 6 km in radius is
    established around it.  Note that in this scenario, zone foci are not
    established around detections, only around units found by trace-outs.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited/very large number of units each day.

    There is no vaccination.

    What should happen:
     - On day 1 unit 0 (sheep) will be Latent.  Unit 0 will ship to the cattle
       unit 10 km north (unit 1) and the pig unit 20 km north (unit 2) but will
       fail to infect them.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected and
       and slated for destruction.  Trace out will find units 1 and 2, which
       will also be slated for destruction.
     - On day 3 a 6 km "High risk" zone will be in effect around units 1 and 2.
       The zone rings will overlap and merge, so the count of separate areas
       making up the "High risk" zone should be 1.  Units 0, 1, and 2 will be
       destroyed.
     - On day 4 the state of units 0, 1, and 2 will show as "Destroyed".
  </parameter-description>

  <diagram>zones_trace_both_merge</diagram>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>trace, infect (new trace modules)</short-name>

  <description>
    This is identical to "trace, infect" above but uses the new (fall 2007)
    tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>21 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_0_nm</parameter-file>

  <parameter-description>
    Parameters: see "trace, infect" above.
  </parameter-description>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>L</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>trace, no infect (new trace modules)</short-name>

  <description>
    This is identical to "trace, no infect" above but uses the new (fall 2007)
    tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>20 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1_nm</parameter-file>

  <parameter-description>
    Parameters: see "trace, no infect" above.
  </parameter-description>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, check reporting variables (new trace modules)</short-name>

  <description>
    This is identical to "trace, no infect, check reporting variables" above
    but uses the new (fall 2007) tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>21 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1_nm_w_vars</parameter-file>

  <parameter-description>
    Parameters: see "trace, no infect, check reporting variables" above.
  </parameter-description>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>2</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>2</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, zone around cattle only, check reporting variables (new trace modules)</short-name>

  <description>
    This is identical to "trace, no infect, zone around cattle only, check
    reporting variables" above but uses the new (fall 2007) tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>21 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_cattle_nm_w_vars</parameter-file>

  <parameter-description>
    Parameters: see "trace, no infect, zone around cattle only, check reporting
    variables" above.
  </parameter-description>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, zone around pigs only, check reporting variables (new trace modules)</short-name>

  <description>
    This is identical to "trace, no infect, zone around pigs only, check
    reporting variables" above but uses the new (fall 2007) tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>21 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_pigs_nm_w_vars</parameter-file>

  <parameter-description>
    Parameters: see "trace, no infect, zone around pigs only, check reporting
    variables" above.
  </parameter-description>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>2</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>trace, no infect, merging, check reporting variables (new trace modules)</short-name>

  <description>
    This is identical to "trace, no infect, merging, check reporting variables"
    above but uses the new (fall 2007) tracing modules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>21 Aug 2007</creation-date>
  <model-version>3.2</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>trace_1_merge_nm_w_vars</parameter-file>

  <parameter-description>
    Parameters: see "trace, no infect, merging, check reporting variables"
    above.
  </parameter-description>

  <output>
    <tr>
      <td>num-separate-areasHighRisk</td>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>expnUAll</td>
      <td>infnUAll</td>
      <td>detnUAll</td>
      <td>desnUAll</td>
      <td>desnUIni</td>
      <td>desnUDet</td>
      <td>desnUDirFwd</td>
      <td>desnUPigs</td>
      <td>desnUBeefCattle</td>
      <td>desnUSheep</td>
      <td>desnUIniPigs</td>
      <td>desnUIniBeefCattle</td>
      <td>desnUIniSheep</td>
      <td>desnUDetPigs</td>
      <td>desnUDetBeefCattle</td>
      <td>desnUDetSheep</td>
      <td>desnUDirFwdPigs</td>
      <td>desnUDirFwdBeefCattle</td>
      <td>desnUDirFwdSheep</td>
    </tr>
    <!-- Areas     | Units in zone          |                                    | Destroyed                                                                           Initially/  Initially/  Initially/   Detected/   Detected/   Detected/    Traced/     Traced/     Traced/   -->
    <!-- High risk | Background  High risk  |  Exposed     Infected    Detected  |   Total     Initially    Detected     Traced       Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep        Pigs       Cattle      Sheep     -->
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>0</td>   <td>3</td>  <td>0</td>   <td>2</td>  <td>0</td>  <td>1</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>3</td>  <td>0</td>  <td>1</td>  <td>2</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>1</td>  <td>1</td>  <td>1</td>  <td>0</td></tr>
    <tr><td>1</td>   <td>1</td>  <td>2</td>   <td>0</td>  <td>0</td>  <td>0</td>   <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td>  <td>0</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>detection, no zones</short-name>

  <description>
    Test that different detection parameters can be set in each zone.  An
    initially infected pig unit infects 2 nearby cattle units.  The pig unit is
    detected, and later on, the cattle are detected too.

    In this scenario, a baseline with no zones, detection for the 2 cattle
    units is the same.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>7 July 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_2cattle_pigs_infected</population-file>

  <parameter-file>detect_1_no_zones</parameter-file>

  <parameter-description>
    For cattle (units 0 and 1), the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 3 days.  For pigs (unit 2), the latent period lasts 1 day,
    day, infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 3 days, and immunity lasts 3 days.

    The probability of airborne spread from a pig unit to a cattle unit at 1 km
    is 0.8248, and the maximum distance of airborne spread is 50 km.  These
    parameters give a 0.505 probability of infection at 20 km.  No parameters
    are set for spread between pig units, between cattle units, or from cattle
    units to pig units.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.

    The probability of detection is 0.4 when a cattle unit first shows clinical
    signs.  It increases linearly to 0.6 after one day.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is fixed at 1.
    
    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.
    
    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 2 (pigs) will be Latent.
     - On day 2 unit 2 (pigs) will be Infectious Subclinical.  It will infect
       units 0 and 1 (cattle).
     - On day 3 units 0 and 1 will be Latent.  Unit 2 (pigs) will be Infectious
       Clinical; it will be detected and marked for destruction.
     - On day 4 unit 2 will be destroyed.  No zones will be in effect.  Units 0
       and 1 will be Infectious Clinical, but will not be detected because p is
       still too low (0.4).
     - On day 5 units 0 and 1 will be detected and marked for destruction.
     - On day 6 units 0 and 1 will be destroyed.
  </parameter-description>

  <output>
    <tr><td>S</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>L</td>  <td>L</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>D</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>D</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>detection, different in 2 zones</short-name>

  <description>
    Test that different detection parameters can be set in each zone.  An
    initially infected pig unit infects 2 nearby cattle units.  The pig unit is
    detected, and later on, the cattle are detected too.

    In this scenario, a zone focus is established around the pig unit.  One
    cattle unit is inside the zone, and is detected a day sooner than the
    cattle unit outside the zone.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>7 July 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_2cattle_pigs_infected</population-file>

  <parameter-file>detect_1_zones</parameter-file>

  <parameter-description>
    For cattle (units 0 and 1), the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 3 days.  For pigs (unit 2), the latent period lasts 1 day,
    day, infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 3 days, and immunity lasts 3 days.

    The probability of airborne spread from a pig unit to a cattle unit at 1 km
    is 0.8248, and the maximum distance of airborne spread is 50 km.  These
    parameters give a 0.505 probability of infection at 20 km.  No parameters
    are set for spread between pig units, between cattle units, or from cattle
    units to pig units.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.

    The probability of detection is 0.4 when a cattle unit first shows clinical
    signs.  It increases linearly to 0.6 after one day.  The probability of
    detection vs. the number of days since a public announcement of an outbreak
    is fixed at 1.

    There are two zones, "High risk" and "Background".  When a diseased pig
    unit is is detected, a "High risk" zone 15 km in radius is established
    around it.  Diseased cattle are twice as likely to be detected inside the
    "High risk" zone.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.
    
    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 2 (pigs) will be Latent.
     - On day 2 unit 2 (pigs) will be Infectious Subclinical.  It will infect
       units 0 and 1 (cattle).
     - On day 3 units 0 and 1 will be Latent.  Unit 2 (pigs) will be Infectious
       Clinical; it will be detected and marked for destruction.
     - On day 4 unit 2 will be destroyed.  A 15 km "High risk" zone will be in
       effect around unit 2.  Units 0 and 1 will be Infectious Clinical.  Unit
       0, which is outside the zone, will not be detected because p is still
       too low (0.4).  Unit 1, which is inside the zone, will be detected
       because of the multiplier (0.4 * 2 = 0.8) and marked for destruction.
     - On day 5 unit 1 will be destroyed.  Unit 0 will be detected and marked
       for destruction.
     - On day 6 unit 0 will be destroyed.
  </parameter-description>

  <output>
    <tr><td>S</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>L</td>  <td>L</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>D</td></tr>
    <tr><td>C</td>  <td>D</td>  <td>D</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>contact between separate foci, no zones</short-name>

  <description>
    Test that the rule for contact between physically separated areas of the
    same zone is respected.  This scenario is a baseline with no zones.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>20 October 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_2</population-file>

  <parameter-file>no_zones_2</parameter-file>

  <parameter-description>
    For pigs (units 0 and 3, on the outside), the latent period lasts 1 day,
    infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 2 days, and immunity lasts 3 days.  For cattle (units
    1 and 2, on the inside), the latent period lasts 3 days, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0 and 3) and the infected cattle unit (1) will
       be Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (1)
       will be Infectious Clinical; it will infect the other cattle unit (2).
     - On day 5 the newly-infected cattle unit (2) will be Latent.
  </parameter-description>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>B</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>L</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>contact between separate foci</short-name>

  <description>
    Test that the rule for contact between physically separated areas of the
    same zone is respected.  This scenario is like "contact between
    separate foci, no zones" above, but it establishes zones that prevent
    shipping between the cattle units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>20 October 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_2</population-file>

  <parameter-file>shipping_separated_areas</parameter-file>

  <parameter-description>
    For pigs (units 0 and 3, on the outside), the latent period lasts 1 day,
    infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 2 days, and immunity lasts 3 days.  For cattle (units
    1 and 2, on the inside), the latent period lasts 3 days, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 1.25 km in radius is established
    around it.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0 and 3) and the infected cattle unit (1) will
       be Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction, and a focus of the "High risk" zone
       1.25 km in radius will be established around each.  The two foci will
       not overlap, therefore the cattle units will now be in separate foci of
       the "High risk" zone.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (1)
       will be Infectious Clinical, but it will not be able to ship to the
       other cattle unit (2) because of the zone rules.
     - On day 5 the other cattle unit (2) will still be Susceptible.
  </parameter-description>

  <diagram>2foci_separate</diagram>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>B</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>contact between joined foci</short-name>

  <description>
    Test that the rule for contact between physically separated areas of the
    same zone is respected.  This scenario is like "contact between
    separate foci" above, but it establishes bigger zones that merge together
    and thus do not prevent shipping between the cattle units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>20 October 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_2</population-file>

  <parameter-file>shipping_joined_areas</parameter-file>

  <parameter-description>
    For pigs (units 0 and 3, on the outside), the latent period lasts 1 day,
    infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 2 days, and immunity lasts 3 days.  For cattle (units
    1 and 2, on the inside), the latent period lasts 3 days, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 1.75 km in radius is established
    around it.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0 and 3) and the infected cattle unit (1) will
       be Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction, and a focus of the "High risk" zone
       1.75 km in radius will be established around each.  The two foci will
       overlap, therefore the cattle units will now be in a single
       dumbbell-shaped "High risk" zone.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (1)
       will be Infectious Clinical; it will infect the other cattle unit (2).
     - On day 5 the newly-infected cattle unit (2) will be Latent.
  </parameter-description>

  <diagram>2foci_joined</diagram>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>B</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>L</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>contact between foci joined after being established</short-name>

  <description>
    Test that the rule for contact between physically separated areas of the
    same zone is respected.  This scenario is like "contact between
    separate foci" above, but 1 day after the separated foci are established,
    it adds another zone that joins the existing 2 foci.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>1 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>5units</population-file>

  <parameter-file>shipping_joined_areas_2</parameter-file>

  <parameter-description>
    For pigs (units 0 and 4, on the outside), the latent period lasts 1 day,
    infectiousness without clinical signs lasts 1 day, infectiousness with
    clinical signs lasts 2 days, and immunity lasts 3 days.  For cattle (units
    1 and 3, on the inside), the latent period lasts 3 days, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.  For sheep (unit 2, above), the latent period lasts
    4 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    or sheep unit is detected, a "High risk" zone 1.25 km in radius is
    established around it.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  The probability of detection vs. the number of days a sheep unit has
    been showing clinical signs is fixed at 1.  The probability of detection
    vs. the number of days since a public announcement of an outbreak is also
    fixed at 1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0 and 4), the infected cattle unit (1), and the
       sheep unit (2) will be Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction, and a focus of the "High risk" zone
       1.25 km in radius will be established around each.  The two foci will
       not overlap, therefore the cattle units will now be in separate foci of
       the "High risk" zone.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (1)
       will be Infectious Clinical, but it will not be able to ship to and
       infect the other cattle unit because of the zone rules.
     - On day 5 the sheep unit will be Infectious Clinical; it will be detected
       and slated for destruction, and a focus of the "High risk" zone 1.25 km
       in radius will be established around it.  The three foci will now be
       joined into a single area.
     - On day 6 the sheep unit will be destroyed.  The infected cattle unit (1)
       will ship to and infect the other cattle unit (3).
     - On day 7 the newly-infected cattle unit (3) will be Latent.
  </parameter-description>

  <diagram>3foci</diagram>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>B</td>  <td>L</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>C</td>  <td>L</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>D</td>  <td>N</td>  <td>D</td>  <td>L</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<variable-test>
  <category>zones</category>
  <short-name>contact between foci joined after being established, check area and perimeter</short-name>

  <description>
    Test the reporting of zone area and perimeter, and the days on which the
    maximum values are reached.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>7 July 2009</creation-date>
  <model-version>3.2</model-version>

  <population-file>5units</population-file>

  <parameter-file>shipping_joined_areas_2_w_vars</parameter-file>

  <parameter-description>
    The parameters are identical to "contact between foci joined after being
    established" above.

    What should happen:
     - On day 4, foci of the "High risk" zone will be in effect around units 0
       and 4.  The foci will not overlap.  Their total area will be 9.82 sq km
       and their total perimeter will be 15.71 km.
     - On day 6 a focus of the zone will be in effect around unit 2.  The total
       area of the "High risk" zone will be 14.05 sq km and its perimeter will
       be 17.99 km.  (See "zone area, 1 zone, 2 foci, merging" and "zone
       perimeter, 1 zone, 2 foci, merging" for examples of how the area and
       perimeter of overlapping zones is calculated.)
  </parameter-description>

  <diagram>3foci</diagram>

  <output>
    <tr>
      <td>zoneAreaHighRisk</td>
      <td>maxZoneAreaHighRisk</td>
      <td>maxZoneAreaDayHighRisk</td>
      <td>finalZoneAreaHighRisk</td>
      <td>zonePerimeterHighRisk</td>
      <td>maxZonePerimeterHighRisk</td>
      <td>maxZonePerimeterDayHighRisk</td>
      <td>finalZonePerimeterHighRisk</td>
    </tr>
    <!--    Area (sq km)                                           |    Perimeter (km)                                          -->
    <tr>    <td>0</td>      <td>0</td>   <td></td>       <td></td>      <td>0</td>      <td>0</td>   <td></td>       <td></td></tr>
    <tr>    <td>0</td>      <td>0</td>   <td></td>       <td></td>      <td>0</td>      <td>0</td>   <td></td>       <td></td></tr>
    <tr>    <td>0</td>      <td>0</td>   <td></td>       <td></td>      <td>0</td>      <td>0</td>   <td></td>       <td></td></tr>
    <tr> <td>9.82</td>   <td>9.82</td>  <td>4</td>       <td></td>  <td>15.71</td>  <td>15.71</td>  <td>4</td>       <td></td></tr>
    <tr> <td>9.82</td>   <td>9.82</td>  <td>4</td>       <td></td>  <td>15.71</td>  <td>15.71</td>  <td>4</td>       <td></td></tr>
    <tr><td>14.05</td>  <td>14.05</td>  <td>6</td>       <td></td>  <td>17.99</td>  <td>17.99</td>  <td>6</td>       <td></td></tr>
    <tr><td>14.05</td>  <td>14.05</td>  <td>6</td>  <td>14.05</td>  <td>17.99</td>  <td>17.99</td>  <td>6</td>  <td>17.99</td></tr>
  </output>
</variable-test>

<deterministic-test>
  <category>zones</category>
  <short-name>enclosure (no donuts rule), no zones</short-name>

  <description>
    Test that the rule that areas enclosed by a zone are absorbed by that zone
    is respected.  This scenario is a baseline with no zones.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>3 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>6units</population-file>

  <parameter-file>no_zones_2</parameter-file>

  <parameter-description>
    For pigs (units 0-3), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle (units 4 and 5), the latent
    period lasts 3 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0-3) and the infected cattle unit (4) will be
       Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (4)
       will be Infectious Clinical; it will infect the other cattle unit (5).
     - On day 5 the newly-infected cattle unit (5) will be Latent.
  </parameter-description>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>B</td>  <td>B</td>  <td>B</td>  <td>B</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td>  <td>D</td>  <td>C</td>  <td>L</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>enclosure (no donuts rule), foci not joined</short-name>

  <description>
    Test that the rule that areas enclosed by a zone are absorbed by that zone
    is respected.  This scenario is like "enclosure (no donuts rule), no zones"
    above, but it establishes zones.  The foci are not large enough to merge
    into an enclosure.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>3 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>6units</population-file>

  <parameter-file>donut_0</parameter-file>

  <parameter-description>
    For pigs (units 0-3), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle (units 4 and 5), the latent
    period lasts 3 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 0.5 km in radius is established around
    it.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0-3) and the infected cattle unit (4) will be
       Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction, and a focus of the "High risk" zone
       0.5 km in radius will be established around each.  The foci will not
       overlap, therefore the cattle unit in the middle (4) will not be
       enclosed.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (4)
       will be Infectious Clinical; it will infect the other cattle unit (5).
     - On day 5 the newly-infected cattle unit (5) will be Latent.
  </parameter-description>

  <diagram>donut_0</diagram>
  
  <output>
    <tr><td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>B</td>  <td>B</td>  <td>B</td>  <td>B</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td>  <td>D</td>  <td>C</td>  <td>L</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>enclosure (no donuts rule), foci joined</short-name>

  <description>
    Test that the rule that areas enclosed by a zone are absorbed by that zone
    is respected.  This scenario is like "enclosure (no donuts rule), foci not
    joined" above, but the foci are large enough to merge into an enclosure.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>3 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>6units</population-file>

  <parameter-file>donut_1</parameter-file>

  <parameter-description>
    For pigs (units 0-3), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle (units 4 and 5), the latent
    period lasts 3 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 shipment
    per day.  The distance of shipments is fixed at 1 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it
    immediately goes to 1.  (This is the opposite of what one might expect from
    movement controls; its purpose here is to make sure any contact we see
    between cattle units happens after the establishment of zones, not before.)
    No parameters are set for movement from cattle units to pig units, from pig
    units to cattle units, or between pig units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 0.75 km in radius is established
    around it.
    
    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig units (0-3) and the infected cattle unit (4) will be
       Latent.
     - On day 2 the pig units will be Infectious Subclinical.
     - On day 3 the pig units will be Infectious Clinical; they will be
       detected and slated for destruction, and a focus of the "High risk" zone
       0.75 km in radius will be established around each.  The foci will
       overlap, therefore the cattle unit in the middle (4) will also be in the
       "High risk" zone.
     - On day 4 the pig units will be destroyed.  The infected cattle unit (4)
       will be Infectious Clinical, but it will not be able to ship to the
       other cattle unit (5) because of the zone rules.
     - On day 5 the other cattle unit (5) will still be Susceptible.
  </parameter-description>

  <diagram>donut_1</diagram>

  <output>
    <tr><td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>B</td>  <td>B</td>  <td>B</td>  <td>B</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>C</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>D</td>  <td>D</td>  <td>D</td>  <td>C</td>  <td>S</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>higher to lower, no zones</short-name>

  <description>
    Test that the rule that units in a zone of a higher surveillance level
    cannot ship to units in a zone of a lower surveillance level is respected.
    This is a baseline scenario with no zones.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>higher_to_lower_0</parameter-file>

  <parameter-description>
    For sheep (unit 0), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle and pigs (units 1 and 2), the
    latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 3 days.

    The movement rate from sheep units to cattle units and from cattle units to
    pig units is fixed at 1 shipment per day.  The distance of shipments is
    fixed at 10 km.  The movement rate multiplier is 0 until the public is
    aware of the outbreak, then it immediately goes to 1.  (This is the
    opposite of what one might expect from movement controls; its purpose here
    is to make sure any contact we see between units happens after the
    establishment of zones, not before.)  No parameters are set for movement in
    the other direction.

    The probability of detection vs. the number of days a sheep unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle or pig units.

    The authorities require 1 day to set up a destruction program before
    beginning.  The authorities can destroy 1 unit each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the sheep unit (0) will be Latent.
     - On day 2 the sheep unit will be Infectious Subclinical.
     - On day 3 the sheep unit will be Infectious Clinical; it will be detected
       and slated for destruction.
     - On day 4 the sheep unit will ship to and infect the cattle unit (1).
     - On day 5 the sheep unit will be destroyed.  The newly-infected cattle
       unit will be Latent.  It will ship to and infect the pig unit (2).
     - On day 6 the newly-infected pig unit will be Latent.
  </parameter-description>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>B</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>N</td>  <td>L</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>C</td>  <td>L</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>higher to lower</short-name>

  <description>
    Test that the rule that units in a zone of a higher surveillance level
    cannot ship to units in a zone of a lower surveillance level is respected.
    This scenario is like "higher to lower, no zones" above, but it establishes
    zones that prevent shipping.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 November 2004</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_cattle_sheep_sheep_infected</population-file>

  <parameter-file>higher_to_lower_1</parameter-file>

  <parameter-description>
    For sheep (unit 0), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle and pigs (units 1 and 2), the
    latent period lasts 1 day, infectiousness lasts 2 days, clinical signs
    accompany infectiousness immediately, and immunity lasts 3 days.

    The movement rate from sheep units to cattle units and from cattle units to
    pig units is fixed at 1 shipment per day.  The distance of shipments is
    fixed at 10 km.  The movement rate multiplier is 0 until the public is
    aware of the outbreak, then it immediately goes to 1.  (This is the
    opposite of what one might expect from movement controls; its purpose here
    is to make sure any contact we see between units happens after the
    establishment of zones, not before.)  No parameters are set for movement in
    the other direction.

    There are three zones, "High risk", "Low risk", and "Disease free".  When a
    diseased sheep unit is detected, a "High risk" zone 5 km in radius and a
    "Low risk" zone 15 km in radius are established around it.

    The probability of detection vs. the number of days a sheep unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle or pig units.

    The authorities require 1 days to set up a destruction program before
    beginning.  The authorities can destroy 1 unit each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the sheep unit (0) will be Latent.
     - On day 2 the sheep unit will be Infectious Subclinical.
     - On day 3 the sheep unit will be Infectious Clinical; it will be detected
       and slated for destruction, and a zone focus will be established around
       it, placing the sheep unit in the "High risk" zone, the cattle unit in
       the "Low risk" zone, and the pig unit in the "Disease free" zone.
     - On day 4 the movement controls allow shipments to start, but the sheep
       unit will not be able to ship to the cattle unit because of the zone
       rules.
     - On day 5 the sheep unit will be destroyed.  The cattle and pig units
       will still be Susceptible.
     - On day 6 the cattle and pig units will still be Susceptible.
  </parameter-description>

  <diagram>2_zone_levels</diagram>

  <output>
    <tr><td>L</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>B</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>N</td>  <td>S</td>  <td>S</td></tr>
    <tr><td>D</td>  <td>S</td>  <td>S</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>gingerbread man rule, no zones</short-name>

  <description>
    Test that the "gingerbread man rule" is obeyed.  The rule states that if
    contact with the best-matching target unit (the one chosen based on
    distance and/or direction from the source) is forbidden by zone rules, then
    the model does not look for another target unit.  (This rule is meant to
    prevent an "edge effect" at the zone boundary.)  In this baseline scenario,
    no zones are triggered.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>15 November 2005</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_2cattle_pigs_infected</population-file>

  <parameter-file>gingerbread_man_0</parameter-file>

  <parameter-description>
    For both cattle and pigs, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The movement rate from pig units to cattle units is fixed at 1 shipment per
    day.  The distance of shipments is fixed at 20 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it goes to
    1.  (This is the opposite of what one might expect from movement controls;
    its purpose here is to make sure any contact we see between units happens
    &lt;i&gt;after&lt;/i&gt; the establishment of zones, not before.)  No
    parameters are set for movement from cattle units to pig units, or from
    cattle units to cattle units.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  Diseased cattle units are not detected.
    
    The authorities require 1 day to set up a destruction program before
    beginning.  The authorities can destroy 1 unit per day.
    
    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 2 (pigs) will be Latent.  Because of the movement control
       multiplier being 0, there will be no shipments.
     - On day 2 unit 2 (pigs) will be Infectious Clinical.  It will be detected
       and marked for destruction.  Because of the movement control multiplier
       being 0, there will be no shipments.
     - On day 3 there is still 1 day left before destructions can begin.  The
       movement control multiplier will be 1, and unit 2 will ship to and
       infect unit 0, 20 km away.
     - On day 4 unit 2 will be destroyed.  Unit 0 will be Latent.
  </parameter-description>

  <output>
    <tr><td>S</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>C</td>  <td>S</td>  <td>D</td></tr>
    <tr><td>N</td>  <td>S</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<deterministic-test>
  <category>zones</category>
  <short-name>gingerbread man rule</short-name>

  <description>
    Test that the "gingerbread man rule" is obeyed.  The rule states that if
    contact with the best-matching target unit (the one chosen based on
    distance and/or direction from the source) is forbidden by zone rules, then
    the model does not look for another target unit.  (This rule is meant to
    prevent an "edge effect" at the zone boundary.)  In this scenario, a zone
    is established around the infected unit and the nearest susceptible unit.
    The suceptible unit inside the zone should not be infected.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>15 November 2005</creation-date>
  <model-version>3.1</model-version>

  <population-file>3units_pigs_2cattle_pigs_infected</population-file>

  <parameter-file>gingerbread_man_1</parameter-file>

  <parameter-description>
    For both cattle and pigs, the latent period lasts 1 day, infectiousness
    lasts 3 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The movement rate from pig units to cattle units is fixed at 1 shipment per
    day.  The distance of shipments is fixed at 20 km.  The movement rate
    multiplier is 0 until the public is aware of the outbreak, then it goes to
    1.  (This is the opposite of what one might expect from movement controls;
    its purpose here is to make sure any contact we see between units happens
    &lt;i&gt;after&lt;/i&gt; the establishment of zones, not before.)  No
    parameters are set for movement from cattle units to pig units, or from
    cattle units to cattle units.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 15 km in radius is established around
    it.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  Diseased cattle units are not detected.
    
    The authorities require 1 day to set up a destruction program before
    beginning.  The authorities can destroy 1 unit per day.
    
    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 unit 2 (pigs) will be Latent.  Because of the movement control
       multiplier being 0, there will be no shipments.
     - On day 2 unit 2 (pigs) will be Infectious Clinical.  It will be detected
       and marked for destruction, and a 15 km radius "High risk" zone will be
       established around it.  The zone will cover unit 1 but not unit 0.
       Because of the movement control multiplier being 0, there will be no
       shipments.
     - On day 3 there is still 1 day left before destructions can begin.  The
       movement control multiplier will be 1.  Unit 2 will generate 1 shipment,
       with unit 0 as the target (20 km away).  The higher-to-lower zone rule
       will forbid contact with unit 0, so no contact will happen.  By the
       gingerbread man rule, unit 0 will not look for another target unit and
       so no shipment will happen to unit 1.
     - On day 4 unit 2 will be destroyed.
  </parameter-description>

  <output>
    <tr><td>S</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>S</td>  <td>D</td></tr>
  </output>
</deterministic-test>

<stochastic-test>
  <category>zones</category>
  <short-name>2 possible recipients, both allowed</short-name>

  <description>
    In direct contact spread, when 2 possible recipients of the same size are
    at the same distance from the source, they should each have a 50/50 chance
    of receiving the shipment.  Test that when contact with 1 of them is
    forbidden by zone rules, the shipment always goes to the other.
    
    This scenario is a baseline where neither recipient is forbidden by zone
    rules.

    NB: This test case does not care about secondary spread, so we end the test
    before that can happen.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>3 November 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_2</population-file>

  <parameter-file>2targets_same_dist_0</parameter-file>
  
  <parameter-description>
    For pigs (unit 3), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle (units 0-2), the latent period
    lasts 3 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 per day.
    The distance of shipments is fixed at 1 km.  Latent units cannot be the
    source of an exposure.  No parameters are set for movement from cattle
    units to pig units or vice versa.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig unit (3) and the infected cattle unit (1) will be
       Latent.
     - On day 2 the pig unit will be Infectious Subclinical.
     - On day 3 the pig unit will be Infectious Clinical; it will be detected
       and slated for destruction.
     - On day 4 the pig unit will be destroyed.  The infected cattle unit (1)
       will be Infectious Clinical; it will ship to and infect either unit 0
       or unit 2.
     - On day 5 the newly-infected cattle unit will be Latent.
  </parameter-description>

  <!-- Cattle unit 0 becomes infected (50/50 chance) -->
  <output probability="0.5">
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>L</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
  </output>

  <!-- Cattle unit 2 becomes infected (50/50 chance) -->
  <output probability="0.5">
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>C</td>  <td>L</td>  <td>D</td></tr>
  </output>
</stochastic-test>

<stochastic-test>
  <category>zones</category>
  <short-name>2 possible recipients, 1 forbidden</short-name>

  <description>
    In direct contact spread, when 2 possible recipients of the same size are
    at the same distance from the source, they should each have a 50/50 chance
    of receiving the shipment.  Test that when contact with 1 of them is
    forbidden by zone rules, the shipment always goes to the other.
    
    In this scenario, shipment to 1 of the possible recipients is forbidden by
    zone rules.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>3 November 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_2</population-file>

  <parameter-file>2targets_same_dist_1</parameter-file>
  
  <parameter-description>
    For pigs (unit 3), the latent period lasts 1 day, infectiousness without
    clinical signs lasts 1 day, infectiousness with clinical signs lasts 2
    days, and immunity lasts 3 days.  For cattle (units 0-2), the latent period
    lasts 3 days, infectiousness lasts 3 days, clinical signs accompany
    infectiousness immediately, and immunity lasts 4 days.

    The movement rate from cattle units to cattle units is fixed at 1 per day.
    The distance of shipments is fixed at 1 km.  Latent units cannot be the
    source of an exposure.  No parameters are set for movement from cattle
    units to pig units or vice versa.

    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 1.5 km in radius is established
    around it.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  No detection parameters are set for cattle units.

    The authorities can begin a destruction program immediately.  The
    authorities can destroy an unlimited number of units each day.

    There is no vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 the pig unit (3) and the infected cattle unit (1) will be
       Latent.
     - On day 2 the pig unit will be Infectious Subclinical.
     - On day 3 the pig unit will be Infectious Clinical; it will be detected
       and slated for destruction.
     - On day 4 a 1.5 km "High risk" zone will be in effect around unit 3.
       Units 0 and 1 will be inside the circle; unit 2 will not.  The infected
       cattle unit (1) will be Infectious Clinical.  Unit 1 will consider
       shipment to either unit 0 or unit 2 (both are 1 km away), but contact
       with unit 2 will be forbidden by the zone rules, so the contact will
       always go to unit 0.
     - On day 5 the newly-infected cattle unit (0) will be Latent.
  </parameter-description>

  <diagram>2targets_1_in_zone</diagram>

  <!-- Cattle unit 0 becomes infected (100% of the time) -->
  <output probability="1">
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>L</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>B</td></tr>
    <tr><td>S</td>  <td>L</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>S</td>  <td>C</td>  <td>S</td>  <td>C</td></tr>
    <tr><td>L</td>  <td>C</td>  <td>S</td>  <td>D</td></tr>
  </output>
</stochastic-test>

<variable-test>
  <category>zones</category>
  <short-name>movement control not changed inside zone</short-name>

  <description>
    Test that special movement controls can be applied by source production
    type and zone.  In this scenario, a zone focus is established around two
    units but no special movement controls are specified, so contacts continue
    as before.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 November 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>movement_control_0</parameter-file>

  <parameter-description>
    For both cattle and pigs, the latent period lasts 3 days, infectiousness
    lasts 5 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The indirect contact rate from cattle units to pig units is fixed at 2 per
    day.  The distance of contacts is fixed at 10 km.  No parameters are set
    for contact for any other production type combinations.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  Diseased cattle units are not detected.
    
    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 15 km in radius is established around
    it.

    There is no destruction or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 both units will be Latent.
     - Day 2 and day 3 will be the same as day 1.
     - On day 4 both units will be Infectious Clinical.  The pig unit will be
       detected.  There will be 2 exposures from unit 0 to unit 1.
     - On day 5, because of the detection, there will be a 15 km radius "High
       risk" zone in effect around unit 1.  Both units will be inside the zone.
       However, because no special movement controls have been set for cattle
       units inside the zone, there will again be 2 exposures from unit 0 to
       unit 1.
     - On days 6, 7, and 8 (the remainder of the Infectious Clinical period)
       there will be 2 exposures from unit 0 to unit 1 each day.
     - On day 9 both units will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>expnUAll</td>
      <td>num-separate-areasHighRisk</td>
    </tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>2</td> <td>0</td></tr>
    <tr><td>2</td> <td>1</td></tr>
    <tr><td>2</td> <td>1</td></tr>
    <tr><td>2</td> <td>1</td></tr>
    <tr><td>2</td> <td>1</td></tr>
    <tr><td>0</td> <td>1</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>movement control changed inside zone</short-name>

  <description>
    Test that special movement controls can be applied by source production
    type and zone.  In this scenario, a zone focus is established around two
    units, and special movement controls apply inside the zone.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 November 2006</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>movement_control_1</parameter-file>

  <parameter-description>
    For both cattle and pigs, the latent period lasts 3 days, infectiousness
    lasts 5 days, clinical signs accompany infectiousness immediately, and
    immunity lasts 4 days.

    The indirect contact rate from cattle units to pig units is fixed at 2 per
    day.  The distance of contacts is fixed at 10 km.  No parameters are set
    for contact for any other production type combinations.

    The probability of detection vs. the number of days a pig unit has been
    showing clinical signs is fixed at 1.  The probability of detection vs. the
    number of days since a public announcement of an outbreak is also fixed at
    1.  Diseased cattle units are not detected.
    
    There are two zones, "High risk" and "Disease free".  When a diseased pig
    unit is detected, a "High risk" zone 15 km in radius is established around
    it.  Inside a "High risk" zone, contact from cattle units is reduced by
    half after a detection.

    There is no destruction or vaccination.

    Recapping what should happen as a result of all this:
     - On day 1 both units will be Latent.
     - Day 2 and day 3 will be the same as day 1.
     - On day 4 both units will be Infectious Clinical.  The pig unit will be
       detected.  There will be 2 exposures from unit 0 to unit 1.
     - On day 5, because of the detection, there will be a 15 km radius "High
       risk" zone in effect around unit 1.  Both units will be inside the zone.
       Because special movement controls have been set for cattle units inside
       the zone, there will be only 1 exposure from unit 0 to unit 1.
     - On days 6, 7, and 8 (the remainder of the Infectious Clinical period)
       there will be 1 exposure from unit 0 to unit 1 each day.
     - On day 9 both units will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>expnUAll</td>
      <td>num-separate-areasHighRisk</td>
    </tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>0</td> <td>0</td></tr>
    <tr><td>2</td> <td>0</td></tr>
    <tr><td>1</td> <td>1</td></tr>
    <tr><td>1</td> <td>1</td></tr>
    <tr><td>1</td> <td>1</td></tr>
    <tr><td>1</td> <td>1</td></tr>
    <tr><td>0</td> <td>1</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count animal days, 1 zone</short-name>

  <description>
    Test that the number of animal-days in a zone is calculated correctly.  In
    this scenario, a zone focus is established around 9 of 16 units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>animal_days_in_zone_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 3 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1.75 km in radius is
    established around it.

    There is no spread, destruction or vaccination.

    What should happen:
     - On day 1 the infected unit (unit 6) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 16, and with 25 animals in each unit, the number of
       animal-days in the "Background" zone should be 16*25=400.
     - On day 2 unit 6 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone, so the number of
       animal-days should increase to 800.
     - On day 3 a 1.75 km "High risk" zone will be in effect around unit 6.
       Nine units will be inside the zone and 7 outside (see diagram below).
       The number of animal-days in the "Background" zone should be
       800+7*25=975, and the number of animal-days in the "High risk" zone
       should be 9*25=225.
     - On day 4 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1150.  The number of animal-days in the "High risk"
       zone should increase by 9*25 to 450.
     - On day 5 the infection will be over and unit 6 will be Immune.  Zones
       are still in effect, so the number of animal-days in the "Background"
       zone should increase by 7*25 to 1325, and the number of animal-days in
       the "High risk" zone should increase by 9*25 to 675.
  </parameter-description>

  <diagram>16units_1_zone</diagram>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>animalDaysInZoneBackground</td>
      <td>animalDaysInZoneHighRisk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>   <td>400</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>   <td>800</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>9</td>   <td>975</td>  <td>225</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>1150</td>  <td>450</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>1325</td>  <td>675</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count animal days, 2 zones</short-name>

  <description>
    Test that the number of animal-days in a zone is calculated correctly.  In
    this scenario, there are 16 units.  A small zone is established that covers
    5 units, and another zone around that covers 4 units.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>animal_days_in_zone_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 3 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 1.25 km in radius and a
    "Low risk" zone 1.75 km in radius are established around it.

    There is no spread, destruction or vaccination.

    What should happen:
     - On day 1 the infected unit (unit 6) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 16, and with 25 animals in each unit, the number of
       animal-days in the "Background" zone should be 16*25=400.
     - On day 2 unit 6 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone, so the number of
       animal-days should increase to 800.
     - On day 3 a 1.25 km "High risk" zone and a 1.75 km "Low risk" zone will
       be in effect around unit 6.  5 units will be in the "High risk" zone,
       another 4 will be in the "Low risk" zone, and 7 will be outside (see
       diagram below).
       The number of animal-days in the "Background" zone should be
       800+7*25=975, the number in the "Low risk" zone should be 4*25=100, and
       the number in the "High risk" zone should be 5*25=125.       
     - On day 4 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1150.  The number in the "Low risk" zone should
       increase by 4*25 to 200.  The number in the "High risk" zone should
       increase by 5*25 to 250.
     - On day 5 the infection will be over and unit 6 will be Immune.  Zones
       are still in effect, so the number of animal-days in the "Background"
       zone should increase by 7*25 to 1325, the number in the "Low risk" zone
       should increase by 4*25 to 300, and the number in the "High risk" zone
       should increase by 5*25 to 375.
  </parameter-description>

  <diagram>16units_2_zones</diagram>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneLowRisk</td>
      <td>unitsInZoneHighRisk</td>
      <td>animalDaysInZoneBackground</td>
      <td>animalDaysInZoneLowRisk</td>
      <td>animalDaysInZoneHighRisk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>400</td>    <td>0</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>800</td>    <td>0</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>   <td>975</td>  <td>100</td>  <td>125</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>1150</td>  <td>200</td>  <td>250</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>1325</td>  <td>300</td>  <td>375</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count animal days, 1 zone, destruction</short-name>

  <description>
    Test that the number of animal-days in a zone is calculated correctly when
    units are destroyed.  In this scenario, a zone focus is established around
    9 of 16 units, and all units within the zone are destroyed.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>animal_days_in_zone_1_w_destr</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 3 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1.75 km in radius is
    established around it and units inside that zone will be destroyed.  The
    authorities can begin a destruction program immediately, and they can
    destroy an unlimited/very large number of units each day.

    There is no spread or vaccination.

    What should happen:
     - On day 1 the infected unit (unit 6) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 16, and with 25 animals in each unit, the number of
       animal-days in the "Background" zone should be 16*25=400.
     - On day 2 unit 6 will be Infectious Clinical.  It will be detected and
       the 9 units around it will be marked for destruction.  There will still
       be just the "Background" zone, so the number of animal-days should
       increase to 800.
     - On day 3 a 1.75 km "High risk" zone will be in effect around unit 6.
       Nine units will be inside the zone and 7 outside (see diagram below).
       The number of animal-days in the "Background" zone should be
       800+7*25=975, and the number of animal-days in the "High risk" zone
       should be 9*25=225.  The units inside the zone will be destroyed.
     - On day 4 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1150.  The number of animal-days in the "High risk"
       zone should not increase because those units are Destroyed.
  </parameter-description>

  <diagram>16units_1_zone</diagram>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>desnUAll</td>
      <td>animalDaysInZoneBackground</td>
      <td>animalDaysInZoneHighRisk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>400</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>800</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>9</td>   <td>975</td>  <td>225</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>0</td>  <td>1150</td>  <td>225</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count animal days, 1 zone, destruction with limit</short-name>

  <description>
    Test that the number of animal-days in a zone is calculated correctly when
    units are destroyed.  In this scenario, a zone focus is established around
    9 of 16 units, and all units within the zone are destroyed over 2 days.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>animal_days_in_zone_1_w_destr_limit</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 3 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1.75 km in radius is
    established around it and units inside that zone will be destroyed.  The
    authorities can begin a destruction program immediately, and they can
    destroy 5 units each day.

    There is no spread or vaccination.

    What should happen:
     - On day 1 the infected unit (unit 6) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 16, and with 25 animals in each unit, the number of
       animal-days in the "Background" zone should be 16*25=400.
     - On day 2 unit 6 will be Infectious Clinical.  It will be detected and
       the 9 units around it will be marked for destruction.  There will still
       be just the "Background" zone, so the number of animal-days should
       increase to 800.
     - On day 3 a 1.75 km "High risk" zone will be in effect around unit 6.
       Nine units will be inside the zone and 7 outside (see diagram below).
       The number of animal-days in the "Background" zone should be
       800+7*25=975, and the number of animal-days in the "High risk" zone
       should be 9*25=225.  5 units inside the zone will be destroyed.
     - On day 4 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1150.  The number of animal-days in the "High risk"
       zone should increase by 4*25 (there are 4 units left) to 325.  The
       remaining 4 units inside the zone will be destroyed.
     - On day 5 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1325.  The number of animal-days in the "High risk"
       zone should not increase because those units are all Destroyed.
  </parameter-description>

  <diagram>16units_1_zone</diagram>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
      <td>desnUAll</td>
      <td>animalDaysInZoneBackground</td>
      <td>animalDaysInZoneHighRisk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>400</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>   <td>800</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>5</td>   <td>975</td>  <td>225</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>4</td>  <td>1150</td>  <td>325</td></tr>
    <tr> <td>7</td>  <td>9</td>  <td>0</td>  <td>1325</td>  <td>325</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count animal days, 2 zones, destruction</short-name>

  <description>
    Test that the number of animal-days in a zone is calculated correctly when
    units are destroyed.  In this scenario, there are 16 units.  A small zone
    is established that covers 5 units, and another zone around that covers 4
    units.  Units in the inner zone are destroyed.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>8 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>animal_days_in_zone_2_w_destr</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 3 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    There are three zones, "High risk", "Low risk" and "Background".  When a
    diseased unit is is detected, a "High risk" zone 1.25 km in radius and a
    "Low risk" zone 1.75 km in radius are established around it.  Units inside
    the "High risk" zone will be destroyed.  The authorities can begin a
    destruction program immediately, and they can destroy an unlimited/very
    large number of units each day.

    There is no spread or vaccination.

    What should happen:
     - On day 1 the infected unit (unit 6) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 16, and with 25 animals in each unit, the number of
       animal-days in the "Background" zone should be 16*25=400.
     - On day 2 unit 6 will be Infectious Clinical.  It will be detected and
       the 5 units around it will be marked for destruction.  There will still
       be just the "Background" zone, so the number of animal-days should
       increase to 800.
     - On day 3 a 1.25 km "High risk" zone and a 1.75 km "Low risk" zone will
       be in effect around unit 6.  5 units will be in the "High risk" zone,
       another 4 will be in the "Low risk" zone, and 7 will be outside (see
       diagram below).
       The number of animal-days in the "Background" zone should be
       800+7*25=975, the number in the "Low risk" zone should be 4*25=105, and
       the number in the "High risk" zone should be 5*25=125.
       The units inside the "High risk" zone will be destroyed.      
     - On day 4 the number of animal-days in the "Background" zone should
       increase by 7*25 to 1150.  The number in the "Low risk" zone should
       increase by 4*25 to 200.  The number in the "High risk" zone should
       not increase because those units are Destroyed.
  </parameter-description>

  <diagram>16units_2_zones</diagram>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneLowRisk</td>
      <td>unitsInZoneHighRisk</td>
      <td>desnUAll</td>
      <td>animalDaysInZoneBackground</td>
      <td>animalDaysInZoneLowRisk</td>
      <td>animalDaysInZoneHighRisk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>400</td>    <td>0</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>800</td>    <td>0</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>5</td>   <td>975</td>  <td>100</td>  <td>125</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>0</td>  <td>1150</td>  <td>200</td>  <td>125</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count units in zone, not using R-tree</short-name>

  <description>
    This scenario and the following one check that the unit-to-zone assignment
    works properly with the use of the R-tree index and without.  In this
    scenario, the diameter of the zone is &gt; 1/4 of the short side of the
    study area, so the R-tree is not used.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>no_rtree_lat0</population-file>

  <parameter-file>rtree_test_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 51.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       47 units will be inside the zone and 4 outside.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
    </tr>
    <tr><td>51</td>   <td>0</td></tr>
    <tr><td>51</td>   <td>0</td></tr>
    <tr> <td>4</td>  <td>47</td></tr>
    <tr> <td>4</td>  <td>47</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>count units in zone, using R-tree</short-name>

  <description>
    This scenario and the previous one check that the unit-to-zone assignment
    works properly with the use of the R-tree index and without.  In this
    scenario, the diameter of the zone is &lt; 1/4 of the short side of the
    study area, so the R-tree is used.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>9 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>rtree_lat0</population-file>

  <parameter-file>rtree_test_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.
       Because there are no zones yet, the count of units in the "Background"
       zone should be 51.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       47 units will be inside the zone and 4 outside.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>unitsInZoneBackground</td>
      <td>unitsInZoneHighRisk</td>
    </tr>
    <tr><td>51</td>   <td>0</td></tr>
    <tr><td>51</td>   <td>0</td></tr>
    <tr> <td>4</td>  <td>47</td></tr>
    <tr> <td>4</td>  <td>47</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone area, equator</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone area is calculated
    correctly.  In this scenario, the zone circle is 1 km in radius and is
    placed at the equator.

    NB: Since polygons are used to approximate zone circles, the area
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>no_rtree_lat0</population-file>

  <parameter-file>zone_area_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The area will be pi*1*1=3.14.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zoneAreaHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>3.14</td></tr>
    <tr><td>3.14</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone area, lat 45</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone area is calculated
    correctly.  In this scenario, the zone circle is 1 km in radius and is
    placed at the 45th parallel.  This will check whether zone circles are
    distorted at higher latitudes.

    NB: Since polygons are used to approximate zone circles, the area
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>no_rtree_lat45</population-file>

  <parameter-file>zone_area_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The area will be pi*1*1=3.14.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zoneAreaHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>3.14</td></tr>
    <tr><td>3.14</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone area, lat -45</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone area is calculated
    correctly.  In this scenario, the zone circle is 1 km in radius and is
    placed at the -45th parallel (southern hemisphere).  This will check
    whether zone circles are distorted at lower latitudes.

    NB: Since polygons are used to approximate zone circles, the area
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>28 May 2008</creation-date>
  <model-version>3.1</model-version>

  <population-file>no_rtree_lat-45</population-file>

  <parameter-file>zone_area_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The area will be pi*1*1=3.14.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zoneAreaHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>3.14</td></tr>
    <tr><td>3.14</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone area, 2 zones</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone area is calculated
    correctly.  In this scenario, two zone circles are created, one 0.5 km in
    radius and the other 1 km in radius.

    NB: Since polygons are used to approximate zone circles, the area
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>14 May 2007</creation-date>
  <model-version>3.1</model-version>

  <population-file>no_rtree_lat0</population-file>

  <parameter-file>zone_area_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 0.5 km in radius and a
    "Low risk" zone 1 km in radius are established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 0.5 km radius "High risk" zone and a 1 km radius "Low risk"
       zone will be in effect around unit 0.  The area of the "High risk" zone
       will be pi*0.5*0.5=0.785.  The area of the "Low risk" zone will be
       pi*1*1 minus the area of the inner "High risk" zone, or 2.36.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zoneAreaLowRisk</td>
      <td>zoneAreaHighRisk</td>
    </tr>
    <tr>   <td>0</td>      <td>0</td></tr>
    <tr>   <td>0</td>      <td>0</td></tr>
    <tr><td>2.36</td>  <td>0.785</td></tr>
    <tr><td>2.36</td>  <td>0.785</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone area, 1 zone, 2 foci, merging</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone area is calculated
    correctly.  In this scenario, two zone circles are created, and they
    overlap.

    NB: Since polygons are used to approximate zone circles, the area
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>7 Oct 2008</creation-date>
  <model-version>3.1</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>zone_area_3</parameter-file>

  <parameter-description>
    Parameters: see "1 zone, 2 foci, merging, check reporting variables" above.

    The area of the zone will be the sum of the areas of the two circles, minus
    the overlap area:

    theta = arccos(5/5.5)
    
    area = 2 * (pi*5.5&lt;sup&gt;2&lt;/sup&gt;*(360-2*theta)/360 + 5*5.5*sin(theta))
    = 186.98 square km.

    Note that maxZoneAreaDay should have no value until a zone is established,
    and finalZoneArea should have no value until the end of the simulation.
  </parameter-description>

  <diagram>1_zone_2_foci_merge_w_triangle</diagram>

  <output>
    <tr>
      <td>zoneAreaHighRisk</td>
      <td>maxZoneAreaHighRisk</td>
      <td>maxZoneAreaDayHighRisk</td>
      <td>finalZoneAreaHighRisk</td>
    </tr>
    <tr>     <td>0</td>       <td>0</td>   <td></td>        <td></td></tr>
    <tr>     <td>0</td>       <td>0</td>   <td></td>        <td></td></tr>
    <tr><td>186.98</td>  <td>186.98</td>  <td>3</td>        <td></td></tr>
    <tr><td>186.98</td>  <td>186.98</td>  <td>3</td>  <td>186.98</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone perimeter, equator</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone perimeter is
    calculated correctly.  In this scenario, the zone circle is 1 km in radius
    and is placed at the equator.

    NB: Since polygons are used to approximate zone circles, the perimeter
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>6 Oct 2008</creation-date>
  <model-version>3.2</model-version>

  <population-file>no_rtree_lat0</population-file>

  <parameter-file>zone_perimeter_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The perimeter will be pi*2=6.28.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zonePerimeterHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>6.28</td></tr>
    <tr><td>6.28</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone perimeter, lat 45</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone perimeter is
    calculated correctly.  In this scenario, the zone circle is 1 km in radius
    and is placed at the 45th parallel.  This will check whether zone circles
    are distorted at higher latitudes.

    NB: Since polygons are used to approximate zone circles, the perimeter
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>6 Oct 2008</creation-date>
  <model-version>3.2</model-version>

  <population-file>no_rtree_lat45</population-file>

  <parameter-file>zone_perimeter_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The perimeter will be pi*2=6.28.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zonePerimeterHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>6.28</td></tr>
    <tr><td>6.28</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone perimeter, lat -45</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone perimeter is
    calculated correctly.  In this scenario, the zone circle is 1 km in radius
    and is placed at the -45th parallel (southern hemisphere).  This will check
    whether zone circles are distorted at lower latitudes.

    NB: Since polygons are used to approximate zone circles, the perimeter
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>6 Oct 2008</creation-date>
  <model-version>3.2</model-version>

  <population-file>no_rtree_lat-45</population-file>

  <parameter-file>zone_perimeter_1</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 1 km in radius is
    established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 1 km radius "High risk" zone will be in effect around unit 0.
       The perimeter will be pi*2=6.28.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zonePerimeterHighRisk</td>
    </tr>
    <tr>   <td>0</td></tr>
    <tr>   <td>0</td></tr>
    <tr><td>6.28</td></tr>
    <tr><td>6.28</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone perimeter, 2 zones</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone perimeter is
    calculated correctly.  In this scenario, two zone circles are created, one
    0.5 km in radius and the other 1 km in radius.

    NB: Since polygons are used to approximate zone circles, the perimeter
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>6 Oct 2008</creation-date>
  <model-version>3.2</model-version>

  <population-file>no_rtree_lat0</population-file>

  <parameter-file>zone_perimeter_2</parameter-file>

  <parameter-description>
    The latent period lasts 1 day, the infectious clinical period lasts 2 days,
    and immunity lasts 3 days.

    The probability of detection vs. the number of days a unit has been showing
    clinical signs is fixed at 1.  The probability of detection vs. the number
    of days since a public announcement of an outbreak is also fixed at 1.

    When a diseased unit is detected, a "High risk" zone 0.5 km in radius and a
    "Low risk" zone 1 km in radius are established around it.

    There is no spread, vaccination, or destruction.

    What should happen:
     - On day 1 the infected unit (unit 0) will be Latent.  There are no zones
       yet.
     - On day 2 unit 0 will be Infectious Clinical.  It will be detected.
       There will still be just the "Background" zone.
     - On day 3 a 0.5 km radius "High risk" zone and a 1 km radius "Low risk"
       zone will be in effect around unit 0.  The perimeter of the "High risk"
       zone will be pi*1=3.14.  The perimeter of the "Low risk" zone will be
       pi*2=6.28.
     - On day 4 unit 0 will be Immune.
  </parameter-description>

  <output>
    <tr>
      <td>zonePerimeterLowRisk</td>
      <td>zonePerimeterHighRisk</td>
    </tr>
    <tr>   <td>0</td>     <td>0</td></tr>
    <tr>   <td>0</td>     <td>0</td></tr>
    <tr><td>6.28</td>  <td>3.14</td></tr>
    <tr><td>6.28</td>  <td>3.14</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone perimeter, 1 zone, 2 foci, merging</short-name>

  <description>
    This is one of a set of 5 scenarios to check that zone perimeter is
    calculated correctly.  In this scenario, two zone circles are created, and
    they overlap.

    NB: Since polygons are used to approximate zone circles, the perimeter
    calculation will not be exact.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>6 Oct 2008</creation-date>
  <model-version>3.2</model-version>

  <population-file>2units_pigs_cattle_all_infected</population-file>

  <parameter-file>zone_perimeter_3</parameter-file>

  <parameter-description>
    Parameters: see "1 zone, 2 foci, merging, check reporting variables" above.

    The perimeter of the zone will be the sum of the perimeters of the two
    circles, minus the two short arcs in the overlap area:

    theta = arccos(5/5.5)
    
    perimeter = 2 * pi*5.5*2 * (360-2*theta)/360 = 59.66 km.

    Note that maxZonePerimeterDay should have no value until a zone is
    established, and finalZonePerimeter should have no value until the end of
    the simulation.
  </parameter-description>

  <diagram>1_zone_2_foci_merge_w_triangle</diagram>

  <output>
    <tr>
      <td>zonePerimeterHighRisk</td>
      <td>maxZonePerimeterHighRisk</td>
      <td>maxZonePerimeterDayHighRisk</td>
      <td>finalZonePerimeterHighRisk</td>
    </tr>
    <tr>    <td>0</td>      <td>0</td>   <td></td>       <td></td></tr>
    <tr>    <td>0</td>      <td>0</td>   <td></td>       <td></td></tr>
    <tr><td>59.66</td>  <td>59.66</td>  <td>3</td>       <td></td></tr>
    <tr><td>59.66</td>  <td>59.66</td>  <td>3</td>  <td>59.66</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone names with accents</short-name>

  <description>
    Test that zone names with accents are handled properly.  This scenario is
    exactly like "count animal days, 2 zones, destruction" above, but with
    some umlauts gratuitously added to the vowels.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>13 May 2008</creation-date>
  <model-version>3.1.17</model-version>

  <population-file>16units_square</population-file>

  <parameter-file>zone_names_utf</parameter-file>

  <parameter-description>
    Parameters: see "count animal days, 2 zones, destruction" above.
  </parameter-description>

  <diagram>16units_2_zones</diagram>

  <output>
    <tr>
      <td>unitsInZoneBckgrond</td>
      <td>unitsInZoneLwRsk</td>
      <td>unitsInZoneHghRsk</td>
      <td>desnUAll</td>
      <td>animalDaysInZoneBckgrond</td>
      <td>animalDaysInZoneLwRsk</td>
      <td>animalDaysInZoneHghRsk</td>
    </tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>400</td>    <td>0</td>    <td>0</td></tr>
    <tr><td>16</td>  <td>0</td>  <td>0</td>  <td>0</td>   <td>800</td>    <td>0</td>    <td>0</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>5</td>   <td>975</td>  <td>100</td>  <td>125</td></tr>
    <tr> <td>7</td>  <td>4</td>  <td>5</td>  <td>0</td>  <td>1150</td>  <td>200</td>  <td>125</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>2 donut holes removed</short-name>

  <description>
    Test that multiple donut holes created by the same zone focus are removed.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>11 December 2009</creation-date>
  <model-version>3.1</model-version>

  <population-file>9units_hexagon</population-file>

  <parameter-file>donut_holes_removed_2</parameter-file>

  <parameter-description>
    For units of production type A and C, the latent period lasts 1 day,
    the infectious clinical period lasts 10 days, and the immune period lasts 5
    days.  Production type B is similar, but adds a 1 day infectious
    subclinical period.

    The rate of shipments from units of type C to other units of type C os
    fixed at 1 per day.  The distance is fixed at 2 km.  The probability of
    infection transfer is 0.

    Units of production type A and B will be detected and reported on the
    first day they show clinical signs.  When a detection occurs, a High risk
    zone with radius 0.75 km will be established around the unit.

    There is no vaccination or destruction.

    What should happen:
     - On each day, there will be 1 exposure, a shipment from unit 7 will to
       unit 8.
     - On day 1, all of the units except unit 8 will be latent.
     - On day 2, units 0-5 will be infectious clinical.  They will be detected.
     - On day 3 the zones around units 0-5 will be established.  The high risk
       zone will be in 2 separate parts.\n\n
       Also on day 3, unit 6 will be infectious clinical.  It will be detected.
     - On day 4 the zone around unit 6 will be established.  It will join the
       two previously established parts of the high risk zone, creating one
       large zone with 2 holes in it, as shown in the diagram below.\n\n
       If the 2 holes were left as holes, one might expect the exposures from
       unit 7 to unit 8 to stop, since those units would now be cut off from
       each other.  But the one exposure each day should continue.
       The scenario is deliberately ended at 6 days.
  </parameter-description>

  <diagram>9units_2_zone_holes</diagram>

  <output>
    <tr>
      <td>expnUAll</td>
      <td>detnUAll</td>
      <td>num-separate-areasHighRisk</td>
    </tr>
    <tr><td>1</td> <td>0</td>  <td>0</td></tr>
    <tr><td>1</td> <td>6</td>  <td>0</td></tr>
    <tr><td>1</td> <td>1</td>  <td>2</td></tr>
    <tr><td>1</td> <td>0</td>  <td>1</td></tr>
    <tr><td>1</td> <td>0</td>  <td>1</td></tr>
    <tr><td>1</td> <td>0</td>  <td>1</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone nesting, 2 zones, lower-level zones not merged</short-name>

  <description>
    Test that the lower-to-higher contact rule (Figure A4-3 in the model
    specification) applies only when the higher-level zone is nested within the
    lower-level zone.
    
    In this scenario, the higher-level zone is not nested within the
    lower-level zone.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>4 January 2010</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_5_xy</population-file>

  <parameter-file>zone_nesting_1</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, the infectious
    clinial period lasts 3 days, and immunity lasts 5 days.

    The contact rate from units of production type B to other units of type
    B is fixed at 1 shipment each day, and the distance is fixed at 3 km.
    There are no contacts for other combinations of production types.

    Units of production type A will be detected and reported on the first day
    they show clinical signs.  When a detection occurs, a High risk zone with
    radius 1.5 km and a Low risk zone with radius 2.5 km will be established
    around the unit.  There is no detection for units of type B.

    There is no destruction or vaccination.

    What should happen:
     - On each day, as long as movement restrictions allow it, there will be an
       exposure from unit 2 to unit 1.
     - On day 1 three of the units will be Latent.
     - On day 2 three of the units will be Infectious Clinical.  Units 0 and 3
       will be detected.
     - On day 3 zones will be in effect around units 0 and 3.  The High risk
       and Low risk zones will each be in two pieces.  Exposures from unit 2
       to unit 1 will stop because unit 1 is in a higher-level zone that is not
       inside the lower-level zone in which unit 2 resides.
     - On day 5 the diseased units will be Immune.
  </parameter-description>

  <diagram>4units_line_5_zones_not_merged</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>expnUAll</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone nesting, 2 zones, lower-level zones merged</short-name>

  <description>
    Test that the lower-to-higher contact rule (Figure A4-3 in the model
    specification) applies only when the higher-level zone is nested within the
    lower-level zone.
    
    In this scenario, the higher-level zone is nested within the lower-level
    zone.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>4 January 2010</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_5_xy</population-file>

  <parameter-file>zone_nesting_2</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, the infectious
    clinial period lasts 3 days, and immunity lasts 5 days.

    The contact rate from units of production type B to other units of type
    B is fixed at 1 shipment each day, and the distance is fixed at 3 km.
    There are no contacts for other combinations of production types.

    Units of production type A will be detected and reported on the first day
    they show clinical signs.  When a detection occurs, a High risk zone with
    radius 1.5 km and a Low risk zone with radius 3.5 km will be established
    around the unit.  There is no detection for units of type B.

    There is no destruction or vaccination.

    What should happen:
     - On each day, as long as movement restrictions allow it, there will be an
       exposure from unit 2 to unit 1.
     - On day 1 three of the units will be Latent.
     - On day 2 three of the units will be Infectious Clinical.  Units 0 and 3
       will be detected.
     - On day 3 zones will be in effect around units 0 and 3.  The High risk
       zone will be in two pieces, but the Low risk zone will be one merged
       piece.  Exposures from unit 2 to unit 1 will continue because unit 1 is
       in a higher-level zone inside the lower-level zone in which unit 2
       resides.
     - On day 5 the diseased units will be Immune and exposures will stop.
  </parameter-description>

  <diagram>4units_line_5_zones_merged</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>expnUAll</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone nesting, 3 zones, attempted contact level 3 to level 1, lowest level zones not merged</short-name>

  <description>
    Test that the lower-to-higher contact rule (Figure A4-3 in the model
    specification) applies only when the higher-level zone is nested within the
    lower-level zone and adjacent to the lower-level zone.
    
    In this scenario, the higher-level zone is not nested within the
    lower-level zone.
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>4 January 2010</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_5_xy</population-file>

  <parameter-file>zone_nesting_3</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, the infectious
    clinial period lasts 3 days, and immunity lasts 5 days.

    The contact rate from units of production type B to other units of type
    B is fixed at 1 shipment each day, and the distance is fixed at 3 km.
    There are no contacts for other combinations of production types.

    Units of production type A will be detected and reported on the first day
    they show clinical signs.  When a detection occurs, a High risk zone with
    radius 1.25 km, a Medium risk zone with radius 1.75 km, and a Low risk
    zone with radius 2.5 km will be established around the unit.  There is no
    detection for units of type B.

    There is no destruction or vaccination.

    What should happen:
     - On each day, as long as movement restrictions allow it, there will be an
       exposure from unit 2 to unit 1.
     - On day 1 three of the units will be Latent.
     - On day 2 three of the units will be Infectious Clinical.  Units 0 and 3
       will be detected.
     - On day 3 zones will be in effect around units 0 and 3.  The High risk,
       Medium risk, and Low risk zones will each be in two pieces.
       Exposures from unit 2 to unit 1 will stop because unit 1 is in a
       higher-level zone that is not inside the lower-level zone in which unit
       2 resides.
     - On day 5 the diseased units will be Immune.
  </parameter-description>

  <diagram>4units_line_5_zones_not_merged_2</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasMediumRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>expnUAll</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>2</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone nesting, 3 zones, attempted contact level 3 to level 1, lowest level zones merged</short-name>

  <description>
    Test that the lower-to-higher contact rule (Figure A4-3 in the model
    specification) applies only when the higher-level zone is nested within the
    lower-level zone and adjacent to the lower-level zone.
    
    In this scenario, the higher-level zone is nested within the lower-level
    zone, but is not adjacent (contact would involve traversing 2 zone levels).
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>4 January 2010</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_5_xy</population-file>

  <parameter-file>zone_nesting_4</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, the infectious
    clinial period lasts 3 days, and immunity lasts 5 days.

    The contact rate from units of production type B to other units of type
    B is fixed at 1 shipment each day, and the distance is fixed at 3 km.
    There are no contacts for other combinations of production types.

    Units of production type A will be detected and reported on the first day
    they show clinical signs.  When a detection occurs, a High risk zone with
    radius 1.25 km, a Medium risk zone with radius 1.75 km, and a Low risk
    zone with radius 3.5 km will be established around the unit.  There is no
    detection for units of type B.

    There is no destruction or vaccination.

    What should happen:
     - On each day, as long as movement restrictions allow it, there will be an
       exposure from unit 2 to unit 1.
     - On day 1 three of the units will be Latent.
     - On day 2 three of the units will be Infectious Clinical.  Units 0 and 3
       will be detected.
     - On day 3 zones will be in effect around units 0 and 3.  The High risk
       and Medium risk zones will each be in two pieces, but the Low risk
       zone will be one merged piece.  Exposures from unit 2 to unit 1 will
       stop because, while unit 1 is in a higher-level zone that is inside the
       lower-level zone in which unit 2 resides, it is not in an adjacent
       zone level (contact would involve traversing 2 zone levels).
     - On day 5 the diseased units will be Immune.
  </parameter-description>

  <diagram>4units_line_5_zones_merged_2</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasMediumRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>expnUAll</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
  </output>
</variable-test>

<variable-test>
  <category>zones</category>
  <short-name>zone nesting, 3 zones, attempted contact level 3 to level 2, lowest level zones merged</short-name>

  <description>
    Test that the lower-to-higher contact rule (Figure A4-3 in the model
    specification) applies only when the higher-level zone is nested within the
    lower-level zone and adjacent to the lower-level zone.
    
    In this scenario, the higher-level zone is nested within the lower-level
    zone, and is adjacent (contact would involve traversing 1 zone level).
  </description>

  <author>Neil Harvey &lt;nharve01@uoguelph.ca&gt;</author>
  <creation-date>4 January 2010</creation-date>
  <model-version>3.1</model-version>

  <population-file>4units_line_5_xy</population-file>

  <parameter-file>zone_nesting_5</parameter-file>

  <parameter-description>
    For all production types, the latent period lasts 1 day, the infectious
    clinial period lasts 3 days, and immunity lasts 5 days.

    The contact rate from units of production type B to other units of type
    B is fixed at 1 shipment each day, and the distance is fixed at 3 km.
    There are no contacts for other combinations of production types.

    Units of production type A will be detected and reported on the first day
    they show clinical signs.  When a detection occurs, a High risk zone with
    radius 0.5 km, a Medium risk zone with radius 1.5 km, and a Low risk
    zone with radius 3.5 km will be established around the unit.  There is no
    detection for units of type B.

    There is no destruction or vaccination.

    What should happen:
     - On each day, as long as movement restrictions allow it, there will be an
       exposure from unit 2 to unit 1.
     - On day 1 three of the units will be Latent.
     - On day 2 three of the units will be Infectious Clinical.  Units 0 and 3
       will be detected.
     - On day 3 zones will be in effect around units 0 and 3.  The High risk
       and Medium risk zones will each be in two pieces, but the Low risk
       zone will be one merged piece.  Exposures from unit 2 to unit 1 will
       continue because unit 1 is in a higher-level zone inside the lower-level
       zone in which unit 2 resides, and it is an adjacent zone level
       (contact would involve traversing 1 zone levels).
     - On day 5 the diseased units will be Immune.
  </parameter-description>

  <diagram>4units_line_5_zones_merged_3</diagram>

  <output>
    <tr>
      <td>num-separate-areasLowRisk</td>
      <td>num-separate-areasMediumRisk</td>
      <td>num-separate-areasHighRisk</td>
      <td>expnUAll</td>
    </tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>0</td>  <td>0</td>  <td>0</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>1</td></tr>
    <tr><td>1</td>  <td>2</td>  <td>2</td>  <td>0</td></tr>
  </output>
</variable-test>
