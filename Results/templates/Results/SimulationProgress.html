{% extends 'Results/navigationPane.html' %}
{% load floppyforms %}
{% load crispy_forms_tags %}

{% block content %}
    {% if large_population %}
        <p>{{ large_population }}</p>
        <img src="/results/Population.png" alt="Unit Locations"/>
    {% else %}
{#        <object type="image/svg+xml"  data="/results/population_d3_map" alt="Unit Locations" width="516px" height="516px">Interactive Graph Failed to Load</object>#}
        <div id="population_zoom" style="cursor: -webkit-zoom-in; height: 80vh;">
            <img src="/results/population_zoom.png" alt="" style="height: 80vh; display: inline-block; "/>
        </div>
        <script src="{{ STATIC_URL }}zoom-master/jquery.zoom.js"></script>
        <script>
            $(document).ready(function(){
                $('#population_zoom').zoom({on:'click'});

                var refreshInterval = setInterval(function(){
                    if (results_status.get_last_progress() < 1)
                        $('#summaryData').load(' #summaryData > table');
                    else
                        clearInterval(refreshInterval);
                }, 300000);
            });
        </script>
    {% endif %}

    <div class="progress" style="width:92vh; position: relative;">
        <span class="simulation-status status-text"></span>
        <div class="simulation-progress progress-bar {% if results_progress == 100 %} done{% endif %}" style="width:{{ results_progress|floatformat:"0" }}%"></div>
    </div>

    <p>Distribution of Outcomes for all Units in the simulation</p>
    <p>Version: {{ version_number }}</p>

    <div id="summaryData">
    {% include "Results/Summary.html" %}
    </div>

    {% if supplemental_files %}
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Supplemental Output Files</h3>
            </div>
            <div class="panel-body">
                <ul id="file_list">
                    {% for file in supplemental_files %}
                        <li>{{ file }}
                            <a href="#" class="delete-button" data-delete-link="{{ file }}"><img src="{{ STATIC_URL }}icons/delete.png" alt="Delete" class="icon pull-right"></a>
                            <a href="/app/Download/{{ file }}/" ><img alt="Download" src="{{ STATIC_URL }}icons/download.png" class="icon pull-right"></a>
                            </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    {% endif %}

    <textarea name="output" id="" cols="30" rows="10">{{ output }}</textarea>
{% endblock %}